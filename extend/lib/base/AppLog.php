<?php 
  namespace lib\base;  use think\Log;  define('FATAL', 1); define('ERROR', 2); define('WARN', 3); define('INFO', 4); define('DEBUG', 5);   class AppLog {            public static function write($url,$request_data,$response_data, $type = INFO,$request_type='get',$run_time=0,$request_route='')      {          if(config('shopxian.applog_level')>=$type){              try {                  $ip= getip();                  $log_id= orderId();                  if(strlen($url)>500)$url= substr ($url, 0, 500);                  $request_data=is_array($request_data)?json_encode($request_data, JSON_UNESCAPED_UNICODE):$request_data;                  $response_data= is_array($response_data)?json_encode($response_data, JSON_UNESCAPED_UNICODE):$response_data;                  appModel('base', 'BaseLog')->save([                      'log_id'=> $log_id,                      'type'=>$type,                     'url'=>$url,                      'request_type'=>$request_type,                      'request_data'=>$request_data,                     'response_data'=>$response_data,                      'ctime'=> date('Y-m-d H:i:s'),                      'run_time'=>$run_time,                      'request_route'=>$request_route,                      'ip'=>$ip                  ],false);                  return 1;              } catch (\Exception  $exc) {                  Log::record('appLog发生致命错误,代码'.$exc->getCode().','.$exc->getFile().',行号'.$exc->getLine().','.$exc->getMessage(),'error');                  exit("日志写入错误".$exc->getMessage());              }                     }          return 0;      }  }  